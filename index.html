<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Ruleta Triple Conc√©ntrica</title>
  <style>

    @import url('https://fonts.cdnfonts.com/css/casino');

    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background: radial-gradient(circle at center, #4e2a84, #2b0e4b);
      color: white;
      margin: 0;
      overflow-x: hidden;
    }

    h1 {
      font-family: 'Casino', sans-serif;
      font-size: 3rem;
      color: #ffeb3b;
      text-shadow: 2px 2px 8px #000, 0 0 25px #ff4081, 0 0 5px #00e5ff;
      margin-bottom: 20px;
      letter-spacing: 3px;
      text-align: center;
    }

    .contenedor {
      position: relative;
      width: 500px;
      height: 500px;
    }

    .ruleta {
      border-radius: 50%;
      border: 6px solid #222;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(0deg);
      transition: transform 4s ease-out;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 25px rgba(255,255,255,0.4);
    }

    .ruleta1 { width: 480px; height: 480px; z-index: 1; }
    .ruleta2 { width: 320px; height: 320px; z-index: 2; background: #fff; }
    .ruleta3 { width: 160px; height: 160px; z-index: 3; background: #fff; }

    .texto-segmento {
      position: absolute;
      transform-origin: center center;
      font-size: 13px;
      font-weight: bold;
      color: #111;
      text-shadow: 1px 1px 2px #fff;
      text-align: center;
      pointer-events: none;
    }

    .botones {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    button {
      padding: 12px 18px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(145deg, #ff4081, #ff9100);
      color: white;
      font-size: 15px;
      cursor: pointer;
      box-shadow: 0 5px 12px rgba(0,0,0,0.4);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 18px rgba(0,0,0,0.6);
    }

    #resultadoModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #ffffff;
      color: #000;
      z-index: 9999;
      text-align: center;
      font-size: 22px;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    #resultadoModal.mostrar {
      display: flex;
    }

    #resultadoModal h2 {
      font-size: 36px;
      margin-bottom: 12px;
      color: #4e2a84;
    }

    #resultadoModal p {
      font-size: 22px;
      margin: 8px 0;
    }

    .small-btn {
      display: inline-block;
      margin-top: 8px;
      padding: 10px 18px;
      background: linear-gradient(145deg, #007bff, #00e5ff);
      color: white;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 18px;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .small-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 18px rgba(0,0,0,0.4);
    }

    .botones-resultado {
      display: flex;
      gap: 20px;
      margin-top: 18px;
    }

    /* === IMAGE DISPLAY STYLES === */
    #imagenNoCompletado {
      margin-top: 20px;
      min-height: 50px;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #imagenNoCompletado img {
      max-width: 320px;
      max-height: 300px;
      margin-top: 18px;
      border-radius: 8px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
      transition: opacity 0.3s ease-in-out;
      object-fit: contain;
    }

    .loading-image { opacity: 0.5; }
    .error-message { color: #f44336; margin-top: 10px; }

    /* === INSTRUCCIONES (boton modal con 3 im√°genes) === */
    #btnHistorialImagenes {
      position: fixed;
      top: 10px;
      right: 10px;
      background: linear-gradient(145deg, #ff9800, #ff5722);
      color: white;
      padding: 10px 16px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      z-index: 2000;
    }
    #historialImagenesModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.95);
      z-index: 3000;
      text-align: center;
      padding: 40px 20px;
    }
    #historialImagenesModal h2 { color: white; margin-bottom: 30px; }
    #cerrarHistorialImagenes {
      position: absolute;
      top: 20px; right: 30px;
      font-size: 40px;
      font-weight: bold;
      color: white;
      cursor: pointer;
    }
    .galeria { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; }
    .galeria img { width: 280px; border-radius: 10px; box-shadow: 0 6px 15px rgba(0,0,0,0.5); transition: transform 0.2s; }
    .galeria img:hover { transform: scale(1.05); }

  </style>
</head>
<body>
  <h1>LA RULETA</h1>
<!-- Dropdown historial -->
<div class="dropdown" id="dropdownHistorial" style="position:fixed; top:10px; left:10px; z-index:2000;">
  <button onclick="toggleDropdown()">Historial ‚ñº</button>
  <div class="dropdown-content" style="display:none; background:#fff; color:#000; min-width:300px; max-height:300px; overflow-y:auto; border-radius:8px; padding:8px;">
    <ul id="listaHistorial" style="margin:0; padding:0; list-style:none;"></ul>
  </div>
</div>

  <!-- Bot√≥n Instrucciones (fijas 3 im√°genes) -->
  <button id="btnHistorialImagenes" type="button"> üìú Instrucciones </button>

  <!-- Modal Instrucciones -->
  <div id="historialImagenesModal" role="dialog" aria-hidden="true">
    <span id="cerrarHistorialImagenes" title="Cerrar">&times;</span>
    <h2>Instrucciones</h2>
    <div class="galeria">
      <img src="imagn/1.png" alt="Imagen 1">
      <img src="imagn/2.png" alt="Imagen 2">
      <img src="imagn/3.png" alt="Imagen 3">
    </div>
  </div>

  <!-- Roulette container -->
  <div class="contenedor">
    <div id="ruleta1" class="ruleta ruleta1"></div>
    <div id="ruleta2" class="ruleta ruleta2"></div>
    <div id="ruleta3" class="ruleta ruleta3"></div>
  </div>

  <!-- Control buttons -->
  <div class="botones">
    <button type="button" onclick="girarIndividual('ruleta1')">Girar Ruleta 1</button>
    <button type="button" onclick="girarIndividual('ruleta2')">Girar Ruleta 2</button>
    <button type="button" onclick="girarIndividual('ruleta3')">Girar Ruleta 3</button>
    <button type="button" onclick="girarTodo()">üéâ Girar Todo üéâ</button>
  </div>

  <!-- Results modal -->
  <div id="resultadoModal" aria-hidden="true" role="dialog">
    <h2 id="resultadoTitle">Resultados</h2>
    <div id="resultadoTexto"></div>
    <div id="temporizador"></div>

    <!-- IMAGE CONTAINER -->
    <div id="imagenNoCompletado"></div>

    <div class="botones-resultado">
      <button id="btnCompletado" class="small-btn" type="button">‚úÖ Completado</button>
      <button id="btnNoCompletado" class="small-btn" style="background:#f44336" type="button">‚ùå No completado</button>
      <!-- Bot√≥n para cerrar solo la ventana de resultados -->
      <button id="btnCerrarResultados" class="small-btn" type="button" style="background: #444; margin-left:8px;">‚úñ Cerrar resultados</button>
    </div>
  </div>

  <!-- Audio elements -->
  <audio id="ding" src="https://www.soundjay.com/buttons/sounds/bell-ringing-05.mp3" preload="auto"></audio>
  <audio id="tic" src="https://www.soundjay.com/clock/sounds/clock-ticking-3.mp3" preload="auto"></audio>

  <!-- Confetti library -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

  <script>
    // === ROULETTE DATA (sin cambios en l√≥gica base) ===
    const datos = {
      ruleta1: "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),
      ruleta2: ["Nombre propio (Inicia con la letra)",
  "Apellido (Inicia con la letra)",
  "Pa√≠s (Inicia con la letra)",
  "Ciudad (Inicia con la letra)",
  "Capital (Inicia con la letra)",
  "Departamento/Estado (Inicia con la letra)",
  "Animal (Inicia con la letra)",
  "Fruta (Inicia con la letra)",
  "Verdura (Inicia con la letra)",
  "Planta o flor (Inicia con la letra)",
  "√Årbol (Inicia con la letra)",
  "Color (Contiene la letra)",
  "Objeto (Inicia con la letra)",
  "Profesi√≥n (Inicia con la letra)",
  "Marca (Inicia con la letra)",
  "Empresa (Inicia con la letra)",
  "Comida (Inicia con la letra)",
  "Bebida (Inicia con la letra)",
  "Postre (Inicia con la letra)",
  "Ingrediente de cocina (Inicia con la letra)",
  "Parte del cuerpo (Contiene la letra)",
  "Ropa (Inicia con la letra)",
  "Calzado (Inicia con la letra)",
  "Accesorio (Inicia con la letra)",
  "Medio de transporte (Inicia con la letra)",
  "Veh√≠culo (Inicia con la letra)",
  "Deporte (Inicia con la letra)",
  "Instrumento musical (Inicia con la letra)",
  "Cantante o grupo musical (Inicia con la letra)",
  "Pel√≠cula (Inicia con la letra)",
  "Serie de TV (Inicia con la letra)",
  "Programa de TV (Inicia con la letra)",
  "Libro (Inicia con la letra)",
  "Personaje de libro (Inicia con la letra)",
  "Personaje hist√≥rico (Inicia con la letra)",
  "Personaje famoso (Inicia con la letra)",
  "Superh√©roe (Inicia con la letra)",
  "Villano (Inicia con la letra)",
  "Videojuego (Inicia con la letra)",
  "Aplicaci√≥n o red social (Inicia con la letra)",
  "P√°gina web (Inicia con la letra)",
  "Palabra en ingl√©s (Inicia con la letra)",
  "Palabra en otro idioma (Inicia con la letra)",
  "Adjetivo (Inicia con la letra)",
  "Acci√≥n o verbo (Inicia con la letra)",
  "Emoci√≥n o sentimiento (Contiene la letra)",
  "Lugar tur√≠stico (Inicia con la letra)",
  "Monumento famoso (Inicia con la letra)",
  "Invento (Inicia con la letra)",
  "Ciencia o rama del conocimiento (Inicia con la letra)",
  "S√≠mbolo o signo (Contiene la letra)",
  "Animal marino (Inicia con la letra)",
  "Ave (Inicia con la letra)",
  "Insecto (Inicia con la letra)",
  "Pa√≠s con mar (Inicia con la letra)",
  "Pa√≠s sin mar (Inicia con la letra)",
  "Isla (Inicia con la letra)",
  "Monta√±a o volc√°n (Inicia con la letra)",
  "Objeto tecnol√≥gico (Inicia con la letra)",
  "Juguete (Inicia con la letra)",
  "Planeta (Inicia con la letra)",
  "Constelaci√≥n (Inicia con la letra)",
  "Estrella famosa (Inicia con la letra)",
  "Sat√©lite natural (Inicia con la letra)",
  "Elemento qu√≠mico (Inicia con la letra)",
  "Metal (Inicia con la letra)",
  "Gas (Inicia con la letra)",
  "Mineral (Inicia con la letra)",
  "Roca (Inicia con la letra)",
  "F√≥sil (Inicia con la letra)",
  "Dinosaurio (Inicia con la letra)",
  "Mam√≠fero (Inicia con la letra)",
  "Reptil (Inicia con la letra)",
  "Anfibio (Inicia con la letra)",
  "Pez (Inicia con la letra)",
  "Marsupial (Inicia con la letra)",
  "Canino (Inicia con la letra)",
  "Felino (Inicia con la letra)",
  "Roedor (Inicia con la letra)",
  "Primates (Inicia con la letra)",
  "Mitolog√≠a griega (Inicia con la letra)",
  "Mitolog√≠a romana (Inicia con la letra)",
  "Mitolog√≠a n√≥rdica (Inicia con la letra)",
  "Mitolog√≠a egipcia (Inicia con la letra)",
  "Dios (Inicia con la letra)",
  "Diosa (Inicia con la letra)",
  "Monstruo mitol√≥gico (Inicia con la letra)",
  "Universidad (Inicia con la letra)",
  "Colegio (Inicia con la letra)",
  "Idioma (Inicia con la letra)",
  "Dialecto (Inicia con la letra)",
  "G√©nero musical (Inicia con la letra)",
  "Canci√≥n (Inicia con la letra)",
  "√Ålbum musical (Inicia con la letra)",
  "Festival de m√∫sica (Inicia con la letra)",
  "Premio musical (Inicia con la letra)",
  "Instrumento de viento (Inicia con la letra)",
  "Instrumento de cuerda (Inicia con la letra)",
  "Instrumento de percusi√≥n (Inicia con la letra)",
  "√ìpera (Inicia con la letra)",
  "Compositor cl√°sico (Inicia con la letra)",
  "Poema (Inicia con la letra)",
  "Poeta (Inicia con la letra)",
  "Novela (Inicia con la letra)",
  "Cuento (Inicia con la letra)",
  "F√°bula (Inicia con la letra)",
  "Obra de teatro (Inicia con la letra)",
  "Tragedia (Inicia con la letra)",
  "Comedia (Inicia con la letra)",
  "Musical (Inicia con la letra)","Nombre propio (Inicia con la letra)",
  "Apellido (Inicia con la letra)",
  "Pa√≠s (Inicia con la letra)",
  "Ciudad (Inicia con la letra)",
  "Capital (Inicia con la letra)",
  "Departamento/Estado (Inicia con la letra)",
  "Animal (Inicia con la letra)",
  "Fruta (Inicia con la letra)",
  "Verdura (Inicia con la letra)",
  "Planta o flor (Inicia con la letra)",
  "√Årbol (Inicia con la letra)",
  "Color (Contiene la letra)",
  "Objeto (Inicia con la letra)",
  "Profesi√≥n (Inicia con la letra)",
  "Marca (Inicia con la letra)",
  "Empresa (Inicia con la letra)",
  "Comida (Inicia con la letra)",
  "Bebida (Inicia con la letra)",
  "Postre (Inicia con la letra)",
  "Ingrediente de cocina (Inicia con la letra)",
  "Parte del cuerpo (Contiene la letra)",
  "Ropa (Inicia con la letra)",
  "Calzado (Inicia con la letra)",
  "Accesorio (Inicia con la letra)",
  "Medio de transporte (Inicia con la letra)",
  "Veh√≠culo (Inicia con la letra)",
  "Deporte (Inicia con la letra)",
  "Instrumento musical (Inicia con la letra)",
  "Cantante o grupo musical (Inicia con la letra)",
  "Pel√≠cula (Inicia con la letra)",
  "Serie de TV (Inicia con la letra)",
  "Programa de TV (Inicia con la letra)",
  "Libro (Inicia con la letra)",
  "Personaje de libro (Inicia con la letra)",
  "Personaje hist√≥rico (Inicia con la letra)",
  "Personaje famoso (Inicia con la letra)",
  "Superh√©roe (Inicia con la letra)",
  "Villano (Inicia con la letra)",
  "Videojuego (Inicia con la letra)",
  "Aplicaci√≥n o red social (Inicia con la letra)",
  "P√°gina web (Inicia con la letra)",
  "Palabra en ingl√©s (Inicia con la letra)",
  "Palabra en otro idioma (Inicia con la letra)",
  "Adjetivo (Inicia con la letra)",
  "Acci√≥n o verbo (Inicia con la letra)",
  "Emoci√≥n o sentimiento (Contiene la letra)",
  "Lugar tur√≠stico (Inicia con la letra)",
  "Monumento famoso (Inicia con la letra)",
  "Invento (Inicia con la letra)",
  "Ciencia o rama del conocimiento (Inicia con la letra)",
  "S√≠mbolo o signo (Contiene la letra)",
  "Animal marino (Inicia con la letra)",
  "Ave (Inicia con la letra)",
  "Insecto (Inicia con la letra)",
  "Pa√≠s con mar (Inicia con la letra)",
  "Pa√≠s sin mar (Inicia con la letra)",
  "Isla (Inicia con la letra)",
  "Monta√±a o volc√°n (Inicia con la letra)",
  "Objeto tecnol√≥gico (Inicia con la letra)",
  "Juguete (Inicia con la letra)",
  "Planeta (Inicia con la letra)",
  "Constelaci√≥n (Inicia con la letra)",
  "Estrella famosa (Inicia con la letra)",
  "Sat√©lite natural (Inicia con la letra)",
  "Elemento qu√≠mico (Inicia con la letra)",
  "Metal (Inicia con la letra)",
  "Gas (Inicia con la letra)",
  "Mineral (Inicia con la letra)",
  "Roca (Inicia con la letra)",
  "F√≥sil (Inicia con la letra)",
  "Dinosaurio (Inicia con la letra)",
  "Mam√≠fero (Inicia con la letra)",
  "Reptil (Inicia con la letra)",
  "Anfibio (Inicia con la letra)",
  "Pez (Inicia con la letra)",
  "Marsupial (Inicia con la letra)",
  "Canino (Inicia con la letra)",
  "Felino (Inicia con la letra)",
  "Roedor (Inicia con la letra)",
  "Primates (Inicia con la letra)",
  "Mitolog√≠a griega (Inicia con la letra)",
  "Mitolog√≠a romana (Inicia con la letra)",
  "Mitolog√≠a n√≥rdica (Inicia con la letra)",
  "Mitolog√≠a egipcia (Inicia con la letra)",
  "Dios (Inicia con la letra)",
  "Diosa (Inicia con la letra)",
  "Monstruo mitol√≥gico (Inicia con la letra)",
  "Universidad (Inicia con la letra)",
  "Colegio (Inicia con la letra)",
  "Idioma (Inicia con la letra)",
  "Dialecto (Inicia con la letra)",
  "G√©nero musical (Inicia con la letra)",
  "Canci√≥n (Inicia con la letra)",
  "√Ålbum musical (Inicia con la letra)",
  "Festival de m√∫sica (Inicia con la letra)",
  "Premio musical (Inicia con la letra)",
  "Instrumento de viento (Inicia con la letra)",
  "Instrumento de cuerda (Inicia con la letra)",
  "Instrumento de percusi√≥n (Inicia con la letra)",
  "√ìpera (Inicia con la letra)",
  "Compositor cl√°sico (Inicia con la letra)",
  "Poema (Inicia con la letra)",
  "Poeta (Inicia con la letra)",
  "Novela (Inicia con la letra)",
  "Cuento (Inicia con la letra)",
  "F√°bula (Inicia con la letra)",
  "Obra de teatro (Inicia con la letra)",
  "Tragedia (Inicia con la letra)",
  "Comedia (Inicia con la letra)",
  "Musical (Inicia con la letra)"],
      ruleta3: ["1","2","3","4","5"]
    };

    // === GLOBAL VARIABLES ===
    let historial = [];
    let contadorHistorial = 1;
    let countdownInterval = null;
    let blinkInterval = null;

    // === IMAGE CONFIGURATION ===
    // Ajusta estos valores seg√∫n tus carpetas / n√∫mero de im√°genes
    const totalImagenes = 92; // n√∫mero de im√°genes en "No Completado"
    const carpetaImagenes = "No Completado"; // carpeta para "No Completado"

    const totalImagenesCompletado = 81; // n√∫mero de im√°genes en "Completado"
    const carpetaCompletado = "Completado"; // carpeta para "Completado"

    // === DEBUG FUNCTION (opcional) ===
    function mostrarDebugInfo() {
      const contenedor = document.getElementById('imagenNoCompletado');
      const currentPath = window.location.href;
      const basePath = currentPath.substring(0, currentPath.lastIndexOf('/') + 1);
      contenedor.innerHTML = `
        <div class="error-message">
          üîç Ruta actual: ${currentPath}<br>
          Carpeta 'No Completado' esperada en: ${basePath}${carpetaImagenes}/<br>
          Carpeta 'Completado' esperada en: ${basePath}${carpetaCompletado}/
        </div>
      `;
    }

    // === ROULETTE FUNCTIONS (no tocar) ===
    function crearRuleta(id, opciones, mostrarTexto = true) {
      const ruleta = document.getElementById(id);
      const num = opciones.length;
      const paso = 360 / num;
      let colores = opciones.map((_, i) => `hsl(${i*360/num}, 80%, 60%) ${i*paso}deg ${(i+1)*paso}deg`).join(", ");
      ruleta.style.background = `conic-gradient(${colores})`;

      if (mostrarTexto) {
        opciones.forEach((texto, i) => {
          const angulo = (i + 0.5) * paso;
          const txt = document.createElement("div");
          txt.className = "texto-segmento";
          txt.style.transform = `rotate(${angulo}deg) translate(${ruleta.offsetWidth/2.5}px) rotate(${-angulo}deg)`;
          txt.textContent = texto;
          ruleta.appendChild(txt);
        });
      }
    }

    function girar(id) {
      const giros = Math.floor(Math.random() * 5) + 5;
      const grados = giros * 360 + Math.floor(Math.random() * 360);
      const ruleta = document.getElementById(id);
      ruleta.style.transform = `translate(-50%, -50%) rotate(${grados}deg)`;
      return grados;
    }

    function obtenerResultado(id, grados) {
      const opciones = datos[id];
      const paso = 360 / opciones.length;
      const indice = Math.floor(((360 - (grados % 360)) % 360) / paso);
      return opciones[indice];
    }

    function getTiempo(valor) {
      switch (valor) {
        case "1": return 10;
        case "2": return 20;
        case "3": return 35;
        case "4": return 50;
        case "5": return 60;
        default: return 0;
      }
    }

    function girarTodo() {
      const g1 = girar("ruleta1");
      const g2 = girar("ruleta2");
      const g3 = girar("ruleta3");
      safePlay('tic');
      setTimeout(() => {
        const resultados = {
          ruleta1: obtenerResultado("ruleta1", g1),
          ruleta2: obtenerResultado("ruleta2", g2),
          ruleta3: obtenerResultado("ruleta3", g3)
        };
        mostrarResultados(resultados);
      }, 4500);
    }

    function girarIndividual(id) {
      const grados = girar(id);
      safePlay('tic');
      setTimeout(() => {
        const r = obtenerResultado(id, grados);
        const last = historial.length ? parseHistEntry(historial[0]) : {ruleta1: "-", ruleta2: "-", ruleta3: "-"};
        const combinado = {
          ruleta1: id === 'ruleta1' ? r : last.ruleta1,
          ruleta2: id === 'ruleta2' ? r : last.ruleta2,
          ruleta3: id === 'ruleta3' ? r : last.ruleta3
        };
        mostrarResultados(combinado);
      }, 4500);
    }

    function parseHistEntry(text) {
      const parts = text.split(':')[1] ? text.split(':')[1].trim().split(',') : ['-','-','-'];
      return { ruleta1: parts[0] ? parts[0].trim() : '-', ruleta2: parts[1] ? parts[1].trim() : '-', ruleta3: parts[2] ? parts[2].trim() : '-' };
    }

    function safePlay(id) {
      const el = document.getElementById(id);
      if (!el) return;
      try { el.currentTime = 0; el.play().catch(()=>{}); } catch(e) {}
    }
function actualizarHistorial() {
  const lista = document.getElementById("listaHistorial");
  if (!lista) return;
  lista.innerHTML = "";
  historial.forEach((item) => {
    const li = document.createElement("li");
    li.textContent = item;
    lista.appendChild(li);
  });
}

function toggleDropdown() {
  const el = document.querySelector('#dropdownHistorial .dropdown-content');
  if (el) {
    el.style.display = el.style.display === "block" ? "none" : "block";
  }
}


    // === RESULTS DISPLAY ===
    function mostrarResultados(resultados) {
      limpiarTimers();
      const modal = document.getElementById("resultadoModal");
      modal.classList.add("mostrar");
      modal.style.background = "white";
      modal.style.color = "black";

      // Clear any previous images
      document.getElementById("imagenNoCompletado").innerHTML = "";

      const texto = `
        <p><b>Ruleta 1:</b> ${resultados.ruleta1 ?? "-"}</p>
        <p><b>Ruleta 2:</b> ${resultados.ruleta2 ?? "-"}</p>
        <p><b>Ruleta 3:</b> ${resultados.ruleta3 ?? "-"}</p>
      `;
      document.getElementById("resultadoTexto").innerHTML = texto;

      safePlay('ding');

      // Confetti effect
      if (typeof confetti === 'function') {
        confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
      }

      // Add to history
      const entry = `Resultado ${contadorHistorial}: ${resultados.ruleta1 ?? "-"}, ${resultados.ruleta2 ?? "-"}, ${resultados.ruleta3 ?? "-"}`;
      historial.unshift(entry);
      contadorHistorial++;
      actualizarHistorial();

      // Timer functionality
      const tiempo = getTiempo(resultados.ruleta3);
      if (tiempo > 0) {
        let restante = tiempo;
        const contadorElem = document.getElementById("temporizador");
        contadorElem.textContent = `${restante} segundos restantes`;

        countdownInterval = setInterval(() => {
          restante--;
          contadorElem.textContent = `${restante} segundos restantes`;

          if (restante <= 3 && restante > 0) {
            if (!blinkInterval) {
              blinkInterval = setInterval(() => {
                const curBg = modal.style.background || 'white';
                if (curBg === 'red') {
                  modal.style.background = 'white';
                  modal.style.color = 'black';
                } else {
                  modal.style.background = 'red';
                  modal.style.color = 'white';
                }
              }, 80);
            }
          }


          if (restante <= 0) {
            clearInterval(countdownInterval); countdownInterval = null;
            if (blinkInterval) { clearInterval(blinkInterval); blinkInterval = null; }
            modal.style.background = 'white';
            modal.style.color = 'black';
            contadorElem.textContent = '¬°Tiempo terminado!';
            safePlay('ding');
          }
        }, 1000);
      } else {
        document.getElementById("temporizador").textContent = "";
      }
    }

    function limpiarTimers() {
      if (countdownInterval) { clearInterval(countdownInterval); countdownInterval = null; }
      if (blinkInterval) { clearInterval(blinkInterval); blinkInterval = null; }
    }

    // === HISTORY / DROPDOWN ===
    function actualizarHistorial() {
      const lista = document.getElementById("listaHistorial");
      if (!lista) return;
      lista.innerHTML = "";
      historial.forEach((item) => {
        const li = document.createElement("li");
        li.textContent = item;
        lista.appendChild(li);
      });
    }
    function toggleDropdown() {
      const el = document.getElementById('dropdownHistorial');
      if (el) el.classList.toggle('show');
    }

    // === IMAGE FUNCTIONS ===
    // Usamos encodeURI al construir rutas para soportar espacios en nombres de carpeta
    function mostrarImagenAleatoria() {
      const numeroImagen = Math.floor(Math.random() * totalImagenes) + 1;
      const rutaImagen = encodeURI(`${carpetaImagenes}/${numeroImagen}.png`);
      const contenedor = document.getElementById('imagenNoCompletado');

      console.log(`Intentando cargar: ${rutaImagen}`);
      contenedor.innerHTML = '<p class="loading-text">üîÑ Cargando imagen...</p>';

      const img = document.createElement('img');
      img.src = rutaImagen;
      img.alt = `No completado (imagen ${numeroImagen})`;
      img.className = 'loading-image';

      const timeoutId = setTimeout(() => {
        if (!img.complete) {
          contenedor.innerHTML = `<div class="error-message">‚è∞ Timeout cargando ${rutaImagen}</div>`;
        }
      }, 7000);

      img.onload = function() {
        clearTimeout(timeoutId);
        img.classList.remove('loading-image');
        contenedor.innerHTML = '';
        contenedor.appendChild(img);
        // Asegurar que el modal est√© visible si se llam√≥ desde fuera
        document.getElementById('resultadoModal').classList.add('mostrar');
      };

      img.onerror = function() {
        clearTimeout(timeoutId);
        contenedor.innerHTML = `
          <div class="error-message">
            ‚ùå No se pudo cargar ${rutaImagen}<br>
            Comprueba nombre/case y que la carpeta exista.
            <br><button onclick="mostrarDebugInfo()" style="margin-top:8px">üîç Debug</button>
          </div>
        `;
      };
    }

    function mostrarImagenCompletado() {
      const numeroImagen = Math.floor(Math.random() * totalImagenesCompletado) + 1;
      const rutaImagen = encodeURI(`${carpetaCompletado}/${numeroImagen}.png`);
      const contenedor = document.getElementById('imagenNoCompletado');

      console.log(`Intentando cargar (Completado): ${rutaImagen}`);
      contenedor.innerHTML = '<p class="loading-text">üîÑ Cargando imagen de Completado...</p>';

      const img = document.createElement('img');
      img.src = rutaImagen;
      img.alt = `Completado (imagen ${numeroImagen})`;
      img.className = 'loading-image';

      const timeoutId = setTimeout(() => {
        if (!img.complete) {
          contenedor.innerHTML = `<div class="error-message">‚è∞ Timeout cargando ${rutaImagen}</div>`;
        }
      }, 7000);

      img.onload = function() {
        clearTimeout(timeoutId);
        img.classList.remove('loading-image');
        contenedor.innerHTML = '';
        contenedor.appendChild(img);
        document.getElementById('resultadoModal').classList.add('mostrar');
      };

      img.onerror = function() {
        clearTimeout(timeoutId);
        contenedor.innerHTML = `
          <div class="error-message">
            ‚ùå No se pudo cargar ${rutaImagen}<br>
            Comprueba nombre/case y que la carpeta exista.
            <br><button onclick="mostrarDebugInfo()" style="margin-top:8px">üîç Debug</button>
          </div>
        `;
      };
    }

    // === EVENT LISTENERS ===
    document.addEventListener('DOMContentLoaded', () => {
      // Inicializar ruletas (mantener comportamiento original)
      crearRuleta("ruleta1", datos.ruleta1, true);
      crearRuleta("ruleta2", datos.ruleta2, false);
      crearRuleta("ruleta3", datos.ruleta3, true);

      const btnCompletado = document.getElementById('btnCompletado');
      const btnNoCompletado = document.getElementById('btnNoCompletado');
      const btnCerrarResultados = document.getElementById('btnCerrarResultados');

      if (btnCompletado) {
        btnCompletado.addEventListener('click', () => {
          console.log('‚úÖ Bot√≥n "Completado" presionado');
          mostrarImagenCompletado();
        });
      }

      if (btnNoCompletado) {
        btnNoCompletado.addEventListener('click', () => {
          console.log('‚ùå Bot√≥n "No completado" presionado');
          mostrarImagenAleatoria();
        });
      }

      if (btnCerrarResultados) {
        btnCerrarResultados.addEventListener('click', () => {
          const modal = document.getElementById('resultadoModal');
          modal.classList.remove('mostrar');
          document.getElementById('imagenNoCompletado').innerHTML = '';
          limpiarTimers();
          console.log('‚úñ Modal de resultados cerrado (solo modal).');
        });
      }

      // Instrucciones modal (las 3 im√°genes fijas)
      const btnHistorialImagenes = document.getElementById("btnHistorialImagenes");
      const modalHistorial = document.getElementById("historialImagenesModal");
      const cerrarHistorial = document.getElementById("cerrarHistorialImagenes");
      btnHistorialImagenes.addEventListener("click", () => modalHistorial.style.display = "block");
      cerrarHistorial.addEventListener("click", () => modalHistorial.style.display = "none");
      window.addEventListener("click", (e) => { if (e.target === modalHistorial) modalHistorial.style.display = "none"; });

      // Cerrar modal resultados con ESC
      document.addEventListener('keydown', (e) => {
        if (e.key === "Escape") {
          const modal = document.getElementById('resultadoModal');
          if (modal.classList.contains('mostrar')) {
            modal.classList.remove('mostrar');
            document.getElementById('imagenNoCompletado').innerHTML = '';
            limpiarTimers();
            console.log('Modal de resultados cerrado con ESC');
          }
        }
      });

      console.log(`üéØ Ruleta inicializada. Carpetas: "${carpetaImagenes}" y "${carpetaCompletado}"`);
    });

  </script>
</body>
</html>
  <script>
function actualizarHistorial() {
  const lista = document.getElementById("listaHistorial");
  if (!lista) return; // seguridad
  lista.innerHTML = "";
  historial.forEach((item) => {
    const li = document.createElement("li");
    li.textContent = item;
    lista.appendChild(li);
  });
}

// ‚úÖ Abre/cierra el men√∫ desplegable
function toggleDropdown() {
  const el = document.querySelector('#dropdownHistorial .dropdown-content');
  if (!el) return;
  el.style.display = (el.style.display === "block") ? "none" : "block";
}

    // === ROULETTE DATA ===
    const datos = {
      ruleta1: "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),
      ruleta2: ["Nombre propio (Inicia con la letra)",
  "Apellido (Inicia con la letra)",
  "Pa√≠s (Inicia con la letra)",
  "Ciudad (Inicia con la letra)",
  "Capital (Inicia con la letra)",
  "Departamento/Estado (Inicia con la letra)",
  "Animal (Inicia con la letra)",
  "Fruta (Inicia con la letra)",
  "Verdura (Inicia con la letra)",
  "Planta o flor (Inicia con la letra)",
  "√Årbol (Inicia con la letra)",
  "Color (Contiene la letra)",
  "Objeto (Inicia con la letra)",
  "Profesi√≥n (Inicia con la letra)",
  "Marca (Inicia con la letra)",
  "Empresa (Inicia con la letra)",
  "Comida (Inicia con la letra)",
  "Bebida (Inicia con la letra)",
  "Postre (Inicia con la letra)",
  "Ingrediente de cocina (Inicia con la letra)",
  "Parte del cuerpo (Contiene la letra)",
  "Ropa (Inicia con la letra)",
  "Calzado (Inicia con la letra)",
  "Accesorio (Inicia con la letra)",
  "Medio de transporte (Inicia con la letra)",
  "Veh√≠culo (Inicia con la letra)",
  "Deporte (Inicia con la letra)",
  "Instrumento musical (Inicia con la letra)",
  "Cantante o grupo musical (Inicia con la letra)",
  "Pel√≠cula (Inicia con la letra)",
  "Serie de TV (Inicia con la letra)",
  "Programa de TV (Inicia con la letra)",
  "Libro (Inicia con la letra)",
  "Personaje de libro (Inicia con la letra)",
  "Personaje hist√≥rico (Inicia con la letra)",
  "Personaje famoso (Inicia con la letra)",
  "Superh√©roe (Inicia con la letra)",
  "Villano (Inicia con la letra)",
  "Videojuego (Inicia con la letra)",
  "Aplicaci√≥n o red social (Inicia con la letra)",
  "P√°gina web (Inicia con la letra)",
  "Palabra en ingl√©s (Inicia con la letra)",
  "Palabra en otro idioma (Inicia con la letra)",
  "Adjetivo (Inicia con la letra)",
  "Acci√≥n o verbo (Inicia con la letra)",
  "Emoci√≥n o sentimiento (Contiene la letra)",
  "Lugar tur√≠stico (Inicia con la letra)",
  "Monumento famoso (Inicia con la letra)",
  "Invento (Inicia con la letra)",
  "Ciencia o rama del conocimiento (Inicia con la letra)",
  "S√≠mbolo o signo (Contiene la letra)",
  "Animal marino (Inicia con la letra)",
  "Ave (Inicia con la letra)",
  "Insecto (Inicia con la letra)",
  "Pa√≠s con mar (Inicia con la letra)",
  "Pa√≠s sin mar (Inicia con la letra)",
  "Isla (Inicia con la letra)",
  "Monta√±a o volc√°n (Inicia con la letra)",
  "Objeto tecnol√≥gico (Inicia con la letra)",
  "Juguete (Inicia con la letra)",
  "Planeta (Inicia con la letra)",
  "Constelaci√≥n (Inicia con la letra)",
  "Estrella famosa (Inicia con la letra)",
  "Sat√©lite natural (Inicia con la letra)",
  "Elemento qu√≠mico (Inicia con la letra)",
  "Metal (Inicia con la letra)",
  "Gas (Inicia con la letra)",
  "Mineral (Inicia con la letra)",
  "Roca (Inicia con la letra)",
  "F√≥sil (Inicia con la letra)",
  "Dinosaurio (Inicia con la letra)",
  "Mam√≠fero (Inicia con la letra)",
  "Reptil (Inicia con la letra)",
  "Anfibio (Inicia con la letra)",
  "Pez (Inicia con la letra)",
  "Marsupial (Inicia con la letra)",
  "Canino (Inicia con la letra)",
  "Felino (Inicia con la letra)",
  "Roedor (Inicia con la letra)",
  "Primates (Inicia con la letra)",
  "Mitolog√≠a griega (Inicia con la letra)",
  "Mitolog√≠a romana (Inicia con la letra)",
  "Mitolog√≠a n√≥rdica (Inicia con la letra)",
  "Mitolog√≠a egipcia (Inicia con la letra)",
  "Dios (Inicia con la letra)",
  "Diosa (Inicia con la letra)",
  "Monstruo mitol√≥gico (Inicia con la letra)",
  "Universidad (Inicia con la letra)",
  "Colegio (Inicia con la letra)",
  "Idioma (Inicia con la letra)",
  "Dialecto (Inicia con la letra)",
  "G√©nero musical (Inicia con la letra)",
  "Canci√≥n (Inicia con la letra)",
  "√Ålbum musical (Inicia con la letra)",
  "Festival de m√∫sica (Inicia con la letra)",
  "Premio musical (Inicia con la letra)",
  "Instrumento de viento (Inicia con la letra)",
  "Instrumento de cuerda (Inicia con la letra)",
  "Instrumento de percusi√≥n (Inicia con la letra)",
  "√ìpera (Inicia con la letra)",
  "Compositor cl√°sico (Inicia con la letra)",
  "Poema (Inicia con la letra)",
  "Poeta (Inicia con la letra)",
  "Novela (Inicia con la letra)",
  "Cuento (Inicia con la letra)",
  "F√°bula (Inicia con la letra)",
  "Obra de teatro (Inicia con la letra)",
  "Tragedia (Inicia con la letra)",
  "Comedia (Inicia con la letra)",
  "Musical (Inicia con la letra)","Nombre de r√≠o extranjero (Inicia con letra)",
  "Nombre de volc√°n famoso (Inicia con letra)",
  "Playa reconocida (Inicia con letra)",
  "Acr√≥nimo famoso (Contiene letra)",
  "Hashtag de tendencia (Contiene letra)",
  "Nombre de mascota (Inicia con letra)",
  "Apodo famoso (Inicia con letra)",
  "Idioma inventado (Inicia con letra)",
  "App viral (Inicia con letra)",
  "Cuento infantil cl√°sico (Inicia con letra)",
  "Villano de pel√≠cula animada (Inicia con letra)",
  "Nombre de un perfume (Inicia con letra)",
  "Marca de autom√≥vil (Inicia con letra)",
  "Personaje de videojuego femenino (Inicia con letra)",
  "Dibujo animado de los 90s (Inicia con letra)",
  "Monstruo de videojuego (Inicia con letra)",
  "Canci√≥n viral de TikTok (Inicia con letra)",
  "T√≠tulo de un reality show (Inicia con letra)",
  "Aplicaci√≥n de mensajer√≠a (Inicia con letra)",
  "Celebridad de internet (Inicia con letra)",
  "Animal mitol√≥gico latinoamericano (Inicia con letra)",
  "Leyenda urbana de tu pa√≠s (Inicia con letra)",
  "Estrella de cine cl√°sico (Inicia con letra)",
  "Palabra inventada divertida (Inicia con letra)",
  "Grupo de rock latino (Inicia con letra)",
  "Marca de tel√©fono (Inicia con letra)",
  "Podcast famoso (Inicia con letra)",
  "Juego de mesa cl√°sico (Inicia con letra)",
  "Objeto que usas en la cocina (Contiene letra)",
  "Objeto de oficina (Contiene letra)",
  "Accesorio de moda (Contiene letra)",
  "Animal acu√°tico (Contiene letra)",
  "Superh√©roe de Marvel (Inicia con letra)",
  "Superh√©roe de DC (Inicia con letra)",
  "Villano de c√≥mic (Inicia con letra)",
  "Youtuber de tecnolog√≠a (Inicia con letra)",
  "Streamer de Twitch (Inicia con letra)",
  "Plato t√≠pico de Colombia (Inicia con letra)",
  "Plato t√≠pico mexicano (Inicia con letra)",
  "Bebida t√≠pica latinoamericana (Inicia con letra)",
  "Serie animada japonesa (Inicia con letra)",
  "Personaje de anime cl√°sico (Inicia con letra)",
  "K-Pop Idol (Inicia con letra)",
  "Grupo de K-Pop (Inicia con letra)",
  "Instrumento musical raro (Inicia con letra)",
  "Evento hist√≥rico mundial (Inicia con letra)",
  "Fen√≥meno natural extra√±o (Inicia con letra)",
  "Objeto de la antig√ºedad (Inicia con letra)",
  "Personaje de caricatura mexicana (Inicia con letra)",
  "Villano de Disney (Inicia con letra)",
  "Princesa de Disney (Inicia con letra)"],
      ruleta3: ["1","2","3","4","5"]
    };

    // === GLOBAL VARIABLES ===
    let historial = [];
    let contadorHistorial = 1;
    let countdownInterval = null;
    let blinkInterval = null;

    // === IMAGE CONFIGURATION ===
    const totalImagenes = 92; // Change this to match your number of images
    const carpetaImagenes = "No Completado"; // ‚úÖ CAMBIADO: ahora busca en la carpeta "imagen"

    // === DEBUG FUNCTION ===
    function mostrarDebugInfo() {
      const contenedor = document.getElementById('imagenNoCompletado');
      const currentPath = window.location.href;
      const basePath = currentPath.substring(0, currentPath.lastIndexOf('/') + 1);
      
      contenedor.innerHTML = `
        <div class="debug-info">
          <strong>üîç Informaci√≥n de Debug:</strong><br>
          üìÅ Ruta actual: ${currentPath}<br>
          üìÇ Carpeta base: ${basePath}<br>
          üñºÔ∏è Buscando im√°genes en: ${basePath}${carpetaImagenes}/<br>
          üìä Total de im√°genes configuradas: ${totalImagenes}<br>
          üìã Archivos esperados: ${Array.from({length: totalImagenes}, (_, i) => `${i+1}.png`).join(', ')}<br><br>
          <strong>‚úÖ Verifica que tengas:</strong><br>
          ‚Ä¢ Carpeta "${carpetaImagenes}" en la misma ubicaci√≥n que tu archivo HTML<br>
          ‚Ä¢ Archivos nombrados exactamente: 1.png, 2.png, 3.png, etc.<br>
          ‚Ä¢ Permisos de lectura en los archivos
        </div>
      `;
    }

    // === ROULETTE FUNCTIONS ===
    function crearRuleta(id, opciones, mostrarTexto = true) {
      const ruleta = document.getElementById(id);
      const num = opciones.length;
      const paso = 360 / num;
      let colores = opciones.map((_, i) => `hsl(${i*360/num}, 80%, 60%) ${i*paso}deg ${(i+1)*paso}deg`).join(", ");
      ruleta.style.background = `conic-gradient(${colores})`;

      if (mostrarTexto) {
        opciones.forEach((texto, i) => {
          const angulo = (i + 0.5) * paso;
          const txt = document.createElement("div");
          txt.className = "texto-segmento";
          txt.style.transform = `rotate(${angulo}deg) translate(${ruleta.offsetWidth/2.5}px) rotate(${-angulo}deg)`;
          txt.textContent = texto;
          ruleta.appendChild(txt);
        });
      }
    }

    function girar(id) {
      const giros = Math.floor(Math.random() * 5) + 5;
      const grados = giros * 360 + Math.floor(Math.random() * 360);
      const ruleta = document.getElementById(id);
      ruleta.style.transform = `translate(-50%, -50%) rotate(${grados}deg)`;
      return grados;
    }

    function obtenerResultado(id, grados) {
      const opciones = datos[id];
      const paso = 360 / opciones.length;
      const indice = Math.floor(((360 - (grados % 360)) % 360) / paso);
      return opciones[indice];
    }

    function getTiempo(valor) {
      switch (valor) {
        case "1": return 10;
        case "2": return 20;
        case "3": return 35;
        case "4": return 50;
        case "5": return 60;
        default: return 0;
      }
    }

    // === SPIN FUNCTIONS ===
    function girarTodo() {
      const g1 = girar("ruleta1");
      const g2 = girar("ruleta2");
      const g3 = girar("ruleta3");
      safePlay('tic');
      setTimeout(() => {
        const resultados = {
          ruleta1: obtenerResultado("ruleta1", g1),
          ruleta2: obtenerResultado("ruleta2", g2),
          ruleta3: obtenerResultado("ruleta3", g3)
        };
        mostrarResultados(resultados);
      }, 4500);
    }

    function girarIndividual(id) {
      const grados = girar(id);
      safePlay('tic');
      setTimeout(() => {
        const r = obtenerResultado(id, grados);
        const resultados = {
          ruleta1: null,
          ruleta2: null,
          ruleta3: null
        };
        const last = historial.length ? parseHistEntry(historial[0]) : {ruleta1: "-", ruleta2: "-", ruleta3: "-"};
        const combinado = {
          ruleta1: id === 'ruleta1' ? r : last.ruleta1,
          ruleta2: id === 'ruleta2' ? r : last.ruleta2,
          ruleta3: id === 'ruleta3' ? r : last.ruleta3
        };
        mostrarResultados(combinado);
      }, 4500);
    }

    // === UTILITY FUNCTIONS ===
    function parseHistEntry(text) {
      const parts = text.split(':')[1] ? text.split(':')[1].trim().split(',') : ['-','-','-'];
      return { 
        ruleta1: parts[0] ? parts[0].trim() : '-', 
        ruleta2: parts[1] ? parts[1].trim() : '-', 
        ruleta3: parts[2] ? parts[2].trim() : '-' 
      };
    }

    function safePlay(id) {
      const el = document.getElementById(id);
      if (!el) return;
      try { 
        el.currentTime = 0; 
        el.play().catch(()=>{}); 
      } catch(e){ 
        /* ignore audio errors */ 
      }
    }

    // === RESULTS DISPLAY ===
    function mostrarResultados(resultados) {
      limpiarTimers();
      const modal = document.getElementById("resultadoModal");
      modal.classList.add("mostrar");
      modal.style.background = "white";
      modal.style.color = "black";
      
      // Clear any previous images
      document.getElementById("imagenNoCompletado").innerHTML = "";

      const texto = `
        <p><b>Ruleta 1:</b> ${resultados.ruleta1 ?? "-"}</p>
        <p><b>Ruleta 2:</b> ${resultados.ruleta2 ?? "-"}</p>
        <p><b>Ruleta 3:</b> ${resultados.ruleta3 ?? "-"}</p>
      `;
      document.getElementById("resultadoTexto").innerHTML = texto;

      safePlay('ding');

      // Confetti effect
      if (typeof confetti === 'function') {
        confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
      }

      // Add to history
      const entry = `Resultado ${contadorHistorial}: ${resultados.ruleta1 ?? "-"}, ${resultados.ruleta2 ?? "-"}, ${resultados.ruleta3 ?? "-"}`;
      historial.unshift(entry);
      contadorHistorial++;
      actualizarHistorial();

      // Timer functionality
      const tiempo = getTiempo(resultados.ruleta3);
      if (tiempo > 0) {
        let restante = tiempo;
        const contadorElem = document.getElementById("temporizador");
        contadorElem.textContent = `${restante} segundos restantes`;

        countdownInterval = setInterval(() => {
          restante--;
          contadorElem.textContent = `${restante} segundos restantes`;

          if (restante <= 3 && restante > 0) {
            if (!blinkInterval) {
              blinkInterval = setInterval(() => {
                const curBg = modal.style.background || 'white';
                if (curBg === 'red') {
                  modal.style.background = 'white';
                  modal.style.color = 'black';
                } else {
                  modal.style.background = 'red';
                  modal.style.color = 'white';
                }
              }, 40);
            }
          }

          if (restante <= 0) {
            clearInterval(countdownInterval); countdownInterval = null;
            if (blinkInterval) { clearInterval(blinkInterval); blinkInterval = null; }
            modal.style.background = 'white';
            modal.style.color = 'black';
            contadorElem.textContent = '¬°Tiempo terminado!';
            safePlay('ding');
          }
        }, 1000);
      } else {
        document.getElementById("temporizador").textContent = "";
      }
    }

    function limpiarTimers() {
      if (countdownInterval) { 
        clearInterval(countdownInterval); 
        countdownInterval = null; 
      }
      if (blinkInterval) { 
        clearInterval(blinkInterval); 
        blinkInterval = null; 
      }
    }

    // === HISTORY FUNCTIONS ===
    function actualizarHistorial() {
      const lista = document.getElementById("listaHistorial");
      lista.innerHTML = "";
      historial.forEach((item) => {
        const li = document.createElement("li");
        li.textContent = item;
        lista.appendChild(li);
      });
    }

    function toggleDropdown() {
      document.getElementById('dropdownHistorial').classList.toggle('show');
    }

    // === ENHANCED RANDOM IMAGE DISPLAY FUNCTION ===
    function mostrarImagenAleatoria() {
      const numeroImagen = Math.floor(Math.random() * totalImagenes) + 1;
      const rutaImagen = `${carpetaImagenes}/${numeroImagen}.png`; // ‚úÖ CAMBIADO: usa la variable carpetaImagenes
      const contenedor = document.getElementById('imagenNoCompletado');
function mostrarImagenCompletado() {
  const numeroImagen = Math.floor(Math.random() * totalImagenesCompletado) + 1;
  const rutaImagen = `${carpetaCompletado}/${numeroImagen}.png`;
  const contenedor = document.getElementById('imagenNoCompletado'); // usamos el mismo contenedor

  console.log(`üé≤ Mostrando imagen de completado: ${rutaImagen}`);

  // Estado de carga
  contenedor.innerHTML = '<p class="loading-text">üîÑ Cargando imagen de Completado...</p>';

  const img = document.createElement('img');
  img.src = rutaImagen;
  img.alt = `Completado (imagen ${numeroImagen})`;
  img.className = 'loading-image';

  img.onload = function() {
    img.classList.remove('loading-image');
    contenedor.innerHTML = '';
    contenedor.appendChild(img);
  };

  img.onerror = function() {
    contenedor.innerHTML = `
      <div class="error-message">
        ‚ùå No se pudo cargar la imagen de Completado<br>
        üìÇ Ruta esperada: ${rutaImagen}
      </div>
    `;
  };
}

      console.log(`üé≤ N√∫mero aleatorio generado: ${numeroImagen}`);
      console.log(`üìÅ Intentando cargar: ${rutaImagen}`);
      
      // Show loading state
      contenedor.innerHTML = '<p class="loading-text">üîÑ Cargando imagen...</p>';
      
      // Create image element
      const img = document.createElement('img');
      img.src = rutaImagen;
      img.alt = `No completado (imagen ${numeroImagen})`;
      img.className = 'loading-image';
const carpetaCompletado = "Completado"; // ‚úÖ carpeta para im√°genes de completado
const totalImagenesCompletado = 81; // üî¢ ajusta este n√∫mero al total de im√°genes en la carpeta
      
      // Add timeout for loading
      const timeoutId = setTimeout(() => {
        if (img.complete === false) {
          contenedor.innerHTML = `
            <div class="error-message">
              ‚è∞ <strong>Timeout:</strong> La imagen tard√≥ demasiado en cargar<br>
              üìÅ Archivo: ${rutaImagen}<br>
              üí° Verifica que el archivo existe y es accesible
            </div>
          `;
        }
      }, 5000);
      
      // Handle successful load
      img.onload = function() {
        clearTimeout(timeoutId);
        img.classList.remove('loading-image');
        contenedor.innerHTML = '';
        contenedor.appendChild(img);
        console.log(`‚úÖ Imagen cargada exitosamente: ${rutaImagen}`);
      };
      
      // Handle error
      img.onerror = function() {
        clearTimeout(timeoutId);
        console.error(`‚ùå Error cargando imagen: ${rutaImagen}`);
        
        contenedor.innerHTML = `
          <div class="error-message">
            ‚ùå <strong>Error:</strong> No se pudo cargar ${numeroImagen}.png<br>
            üìÅ Ruta esperada: ${rutaImagen}<br><br>
            <button onclick="mostrarDebugInfo()" style="background:#2196f3; color:white; border:none; padding:5px 10px; border-radius:3px; cursor:pointer;">
              üîç Mostrar informaci√≥n de debug
            </button>
          </div>
        `;
      };
    }

    // === EVENT LISTENERS ===
  document.addEventListener('DOMContentLoaded', () => {
  const btnCompletado = document.getElementById('btnCompletado');
  const btnNoCompletado = document.getElementById('btnNoCompletado');
// ‚úÖ Cerrar modal con tecla ESC
document.addEventListener('keydown', (e) => {
  if (e.key === "Escape") {
    const modal = document.getElementById('resultadoModal');
    if (modal.classList.contains('mostrar')) {
      modal.classList.remove('mostrar');
      document.getElementById('imagenNoCompletado').innerHTML = '';
      console.log('‚ùå Modal cerrado con tecla ESC');
    }
  }
});


  // ‚úÖ Bot√≥n Completado
 if (btnCompletado) {
  btnCompletado.addEventListener('click', () => {
    console.log('‚úÖ Bot√≥n "Completado" presionado');
    mostrarImagenCompletado();
  });
}


  // ‚úÖ Bot√≥n No completado ‚Üí Muestra imagen
  if (btnNoCompletado) {
    btnNoCompletado.addEventListener('click', () => {
      console.log('‚ùå Bot√≥n "No completado" presionado');
      mostrarImagenAleatoria(); // üëà aqu√≠ est√° el llamado correcto
    });
  }

  console.log(`üéØ Ruleta inicializada correctamente`);
  console.log(`üìÅ Configurado para ${totalImagenes} im√°genes en carpeta "${carpetaImagenes}"`);
  console.log(`üåê Ubicaci√≥n actual: ${window.location.href}`);
});

    // === INITIALIZATION ===
    // Initialize roulettes when page loads
    crearRuleta("ruleta1", datos.ruleta1, true);
    crearRuleta("ruleta2", datos.ruleta2, false);
    crearRuleta("ruleta3", datos.ruleta3, true);
  </script>
</body>
</html>
